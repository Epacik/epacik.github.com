<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Licznik śmierci Wiśni w Gothicu 2</title>
    <link href="https://fonts.googleapis.com/css?family=Sarpanch&display=swap" rel="stylesheet"> 
    <script src="https://www.gstatic.com/firebasejs/7.7.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/7.7.0/firebase-firestore.js"></script>
    <style>
        div{
            font-size: 24px;
            font-family: 'Sarpanch', sans-serif;
            color: white;
            text-shadow: 0 0 5px black ;
        }

        #amount {
            display: inline-block;
            height: 33px;
            overflow: hidden;
            padding: 5px;
        }

        #amount > div{

        }
    </style>
</head>
<body >
    
    <div style="display: flex;"><span style="padding: 5px;">Licznik śmierci: </span><span id="amount"></span></div>
    <script>
       
        // Required for side-effects
        //require("firebase/firestore");
        // Initialize Cloud Firestore through Firebase
        var config = {
          apiKey: "AIzaSyCo61ez5fN6_hmXsq-0yaSHKunjRnbtkvo",
          authDomain: "epacik-github-io-db.firebaseapp.com",
          databaseURL: "https://epacik-github-io-db.firebaseio.com",
          projectId: "epacik-github-io-db",
          storageBucket: "epacik-github-io-db.appspot.com",
          messagingSenderId: "11190278297"
      };
      firebase.initializeApp(config);
      const db = firebase.firestore();
      db.settings({});

      db.collection('Wisnia').onSnapshot(snapshot => {
        let ch = snapshot.docChanges();
        ch.forEach(change => {
            if (change.type === "added") {
                //addProjectToList(change.doc.id, change.doc.data());
                //document.getElementById("amount").innerHTML = change.doc.data().Licznik;
                ChNum(change.doc.data().Licznik);
            } else if (change.type === "removed") {
                //document.getElementById("amount").innerHTML = 0;
                ChNum(0);
            } else if (change.type === "modified") {
                //document.getElementById("amount").innerHTML = change.doc.data().Licznik;
                ChNum(change.doc.data().Licznik);
            }
        });
    });

      function ChNum(newNum){
            let Holder = document.getElementById("amount");
            let Nums = Holder.children;
            let direction = 1; // 0 = Down; 1 = Stay; 2 = Up;
            if(Nums.length == 0){
                Holder.insertAdjacentHTML("afterbegin", "<div>" + newNum + "</div>");
                return;
            }
            else (Nums.length == 1)
            {
                if(Number(Nums[0].innerHTML) < newNum)
                    direction = 2;
                else if((Number(Nums[0].innerHTML) > newNum))
                    direction = 0;
                else
                    return;
            }

            let curNum = Nums[0];

            let element = document.createElement("div");

            element.innerText = newNum;

            let dir = direction == 2 ? "afterbegin" : "beforeend";

            Holder.insertAdjacentElement(dir, element);

            curNum.scrollIntoView();
            element.scrollIntoView({behavior: 'smooth'});
            setTimeout(()=>{
                Holder.removeChild(curNum);
            }, 200);






      }

    </script>
</body>
</html>